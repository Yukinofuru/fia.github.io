【拡張UIパーツプラグイン】

主にコンフィグ画面向けにUIパーツを追加するプラグインです。

■できること
・スライダーを追加
・スイッチを追加
・セレクトボックスを追加
・カラーピッカーを追加
・デザインカスタマイズ


■使い方
このテキストが入っているフォルダごと「data/others/plugin」フォルダに置きます。
それからfirst.ksとかに以下のように記述してください。
記述した時点から後述のタグを使用可能になります。

[plugin name=uiparts_set]
指定可能属性
なし


■使用可能タグ
slider：スライダーを表示します。fixレイヤーに配置されるため、消去するときは[clearfix]タグを使用してください。
属性：
name（必須）        ：スライダーの名前を指定します。他のname属性値とかぶらないように（一意の値として）指定してください。
x（必須）           ：横方向の位置を指定します（単位：px）。
y（必須）           ：縦方向の位置を指定します（単位：px）。
width               ：スライダーの幅を指定します（単位：px）。初期値は400です。
height              ：スライダーの高さを指定します（単位：px）初期値は4です。
min                 ：スライダーで指定できる最小値を指定します。初期値は0です。
max                 ：スライダーで指定できる最大値を指定します。初期値は100です。
step                ：スライダーが1移動するときに変化する値の量を指定します。基本的に1を指定しておけばいいです。初期値は1です。
border              ：スライダーのボーダーの幅を指定します（単位：px）。初期値は0です。
border_color        ：ボーダーの色を指定します。初期値はwhiteです。
border_radius       ：スライダーの角丸の度合いを指定します（単位：px）。初期値は30です。
thumb_width         ：つまみの幅を指定します（単位：px）。初期値は30です。
thumb_height        ：つまみの高さを指定します（単位：px）。初期値は30です。
thumb_radius        ：つまみの角丸の度合いを指定します（単位：px）。初期値は30です。
thumb_color         ：つまみの色を指定します。初期値はwhiteです。
thumb_border        ：つまみのボーダーの幅を指定します（単位：px）。初期値は0です。
thumb_border_color  ：つまみのボーダーの色を指定します。初期値はwhiteです。
thumb_img           ：つまみの画像を指定します。画像はimageフォルダに配置します。
base_color          ：スライダーのベース色を指定します。初期値は#999です。
active_color        ：スライダーのつまみより左側の色を指定します。初期値はwhiteです。
base_img            ：スライダーのベース画像を指定します。色指定に優先して表示されます。
active_img          ：スライダーのつまみより左側の画像を指定します。色指定に優先して表示されます。
storage             ：スライダーの値を変更した（つまみの位置を止めた）ときにジャンプするシナリオ名を指定します。
target              ：スライダーの値を変更した（つまみの位置を止めた）ときにジャンプするラベル名を指定します。
exp                 ：スライダーの値を変更している（つまみを動かしている）ときに実行するJS式を記述します。
preexp              ：exp属性でmpオブジェクト内の変数を使いたい場合に、変数名を指定します。
var                 ：スライダーで指定した値を格納する変数名を指定します。
tip_width           ：現在の値を表示するツールチップの幅を指定します（単位：px）。初期値は0（表示なし）です。
tip_height          ：現在の値を表示するツールチップの幅を指定します（単位：px）。初期値は0（表示なし）です。
tip_color           ：ツールチップの色を指定します。初期値はwhiteです。
tip_radius          ：ツールチップの角丸の度合いを指定します（単位：px）。初期値は0です。
tip_text_color      ：ツールチップのテキスト色を指定します。初期値はblackです。
tip_text_size       ：ツールチップのテキストサイズを指定します。初期値は24です。
tip_tail            ：ツールチップに吹き出しのしっぽをつけるかを指定します。初期値はtrue（表示あり）です。
tip_pos             ：ツールチップを表示する位置を指定します。指定できる値はtop、bottomです。
tip_margin          ：ツールチップとスライダーの間隔を指定します（単位：px）。初期値は0です。
tip_x               ：tip_pos=staticの場合のツールチップ横位置
tip_y               ：tip_pos=staticの場合のツールチップ縦位置
reverse             ：左側に最大値、右側に最小値としたい場合はtrueを指定。初期値はfalseです。


switch：スイッチを表示します。fixレイヤーに配置されるため、消去するときは[clearfix]タグを使用してください。
属性：
name（必須）        ：スイッチの名前を指定します。他のname属性値とかぶらないように（一意の値として）指定してください。
x（必須）           ：横方向の位置を指定します（単位：px）。
y（必須）           ：縦方向の位置を指定します（単位：px）。
width               ：スイッチの幅を指定します（単位：px）。初期値は60です。
height              ：スイッチの高さを指定します（単位：px）。初期値は4です。
border              ：スイッチのボーダーの幅を指定します（単位：px）。
border_color        ：ボーダーの色を指定します。
border_radius       ：スイッチの角丸の度合いを指定します（単位：px）。
thumb_width         ：つまみの幅を指定します（単位：px）。
thumb_height        ：つまみの高さを指定します（単位：px）。
thumb_radius        ：つまみの角丸の度合いを指定します（単位：px）。
thumb_color         ：つまみの色を指定します。
thumb_border        ：つまみのボーダーの幅を指定します（単位：px）。
thumb_border_color  ：つまみのボーダーの色を指定します。
thumb_img           ：つまみの画像を指定します。画像はimageフォルダに配置します。
base_color          ：スイッチがOFFになっているときの色を指定します。
active_color        ：スイッチがONになっているときの色を指定します。
base_img            ：スイッチがOFFになっているときの画像を指定します。
active_img          ：スイッチがONになっているときの画像を指定します。
storage             ：スイッチをON/OFF切り替えしたときにジャンプするシナリオ名を指定します。
target              ：スイッチをON/OFF切り替えしたときにジャンプするラベル名を指定します。
var                 ：スイッチで指定した値を格納する変数名を指定します。


selectbox   ：セレクトボックスUIを表示します。fixレイヤーに配置されるため、消去するときは[clearfix]タグを使用してください。
指定可能属性
name（必須）    ：セレクトボックスの名前
var（必須）     ：選択した値を格納する変数名
x               ：横位置
y               ：縦位置
width           ：幅
height          ：高さ
selected        ：初期状態で選択済みとするoptionの番号
exp             ：選択時に実行するJS式
preexp          ：exp実行時に変数を使用する場合、変数名を指定（buttonタグのpreexpと同じ）
storage         ：選択時にジャンプするシナリオ
target          ：選択時にジャンプするラベル
bg              ：セレクトボックスの背景色
margin_x        ：セレクトボックスとテキストの横間隔
margin_y        ：セレクトボックスとテキストの縦間隔
font_color      ：文字色
font_size       ：文字サイズ
thumb_image     ：セレクトボックスの「▼」部分（つまみ）の画像
thumb_width     ：つまみの幅
thumb_height    ：つまみ高さ
thumb_left      ：つまみ横位置（セレクトボックス左端基点）
thumb_top       ：つまみ縦位置（セレクトボックス上端基点）
border_radius   ：セレクトボックスの角丸サイズ
border_width    ：セレクトボックスの枠線幅
border_color    ：セレクトボックスの枠線色
option_番号     ：パラメータ名を「option_1」「option_2」、指定値を「表示テキスト,変数に格納する値,フォント名,文字色」のように半角カンマで区切って指定。パラメータ名の番号順に選択リストを表示します


colorpicker ：カラーピッカーを表示します。fixレイヤーに配置されるため、消去するときは[clearfix]タグを使用してください。
指定可能属性
name（必須）    ：カラーピッカーの名前
var（必須）     ：選択した値を格納する変数名。ここで指定した変数にカラーコードが格納されていた場合、初期選択色となる
x               ：横位置
y               ：縦位置
width           ：幅
height          ：高さ
border_width    ：カラーピッカーの枠線幅
border_color    ：カラーピッカーの枠線色
storage         ：選択時にジャンプするシナリオ
target          ：選択時にジャンプするラベル
exp             ：選択時に実行するJS式
preexp          ：exp実行時に変数を使用する場合、変数名を指定（buttonタグのpreexpと同じ）


■使い方のコツ
・基本的には、varパラメータに変更した値を格納する変数名を指定し、targetパラメータに指定したジャンプ先でvarパラメータに指定した変数を利用して何らかの処理を行います。

・expパラメータについては上級者向けの設定です。よくわからない方は使わないでください。

・以下はexpパラメータの使い方の例です。
[iscript]
tf.bgm_exp = function(){
    TYRANO.kag.ftag.startTag("bgmopt", {
        volume: tf.current_bgm_vol
    })
}
[endscript]
[slider name=bgm target="*bgm" var="tf.current_bgm_vol" exp="tf.bgm_exp()" x=85  y=324 width=300 height=2 min=0 max=100 step=1 border_radius=0 thumb_width=24 thumb_height=24 thumb_img="config/thumb_slider.png" tip_width=72 tip_height=32 tip_color="#F2F2F2" tip_text_color="#333" tip_text_size=20 tip_pos=top tip_margin=30]

まず[iscript]～[endscript]タグ内でBGM音量を変更する関数「tf.bgm_exp」を定義し、スライダーを動かすのに合わせてBGM音量が変更されるようになっています。

・[select]タグのoptionパラメータの指定はこんな感じです↓
[selectbox name="test" x=100 y=200 target="*commit" var="f.test" option_1="てすと,test1,serif,red" option_2="てすと２,test2"]
このように指定すると、画面上の選択リストの表示はそれぞれ「てすと」「てすと２」、実際に変数に格納される値は「test1」「test2」となります。

・[colorpicker]タグの実際に色を選択する部分のUIはブラウザ依存です。そのため、PCアプリケーションとブラウザで見た目がだいぶ違います。
できることは同じなので気にしないでください。


■ライセンス
このプラグインはMITライセンスです。
©2023 さくた@skt_tyrano
原文：https://opensource.org/licenses/mit-license.php
和訳：https://licenses.opensource.jp/MIT/MIT.html


■注意事項
ティラノスクリプトv520以降で動作確認しています。
このプラグインを使用したことで生じたあらゆる問題について、製作者は責任を負いません。


■製作者
さくた（@skt_tyrano）
https://skskpnt.app


■更新履歴
2023/11/28  v2.0.1
・他プラグインと併用時競合する可能性があったため修正

2023/06/01  v2.0.0
・セレクトボックス、カラーピッカーを追加
・ライセンスをMITに変更

2022/08/03  v1.5.4
・スライダーのactive部分が正しく表示されない不具合を修正

2022/07/24  v1.5.3
・スライダーのつまみ画像が表示されない不具合を修正
・reverse=trueの場合にツールチップが正しく表示されない不具合を修正

2022/05/01  v1.5.2
・reverseパラメータを追加

2022/02/26  v1.5.1
・ロードを挟んでタグを実行するとつまみが表示されない不具合を修正

2022/02/26  v1.5.0
・スマホでもスライダーがスライドできるように修正

2022/02/23  v1.4.1
・スライダー、スイッチのベースに画像を指定できるパラメータを追加

2022/02/13  v1.4
・スライダー、スイッチのベースに画像を指定できるパラメータを追加

2021/07/01  v1.3
・スライダー、スイッチのつまみに画像を指定できるパラメータを追加

2021/03/16  v1.2
・call中はスライダー・スイッチの入力を受け付けないよう修正
・色々バグ修正

2020/12/09  v1.1
・ツールチップ表示　追加
・readme整備

2020/07  v1.0
・正式公開